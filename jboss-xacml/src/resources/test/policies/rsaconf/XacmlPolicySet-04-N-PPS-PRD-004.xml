<?xml version="1.0" encoding="UTF-8"?>
<PolicySet
    xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os 
      http://docs.oasis-open.org/xacml/access_control-xacml-2.0-policy-schema-os.xsd" 
    PolicySetId="urn:xacml:2.0:interop:example:policysetid:N:PPS:PRD-004"
    PolicyCombiningAlgId=
      "urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:deny-overrides">
  <Description>
      Policy set for the PRD-004 permission. This permission allows
      access to all medical records.
  </Description>
  <Target/>
  <Policy
      PolicyId="urn:xacml:2.0:interop:example:policyid:N:PPS:PRD-004:1"
      RuleCombiningAlgId=
        "urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:deny-overrides">
    <Target>
      <Resources>
        <Resource>
          <ResourceMatch
              MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
            <AttributeValue
                DataType="http://www.w3.org/2001/XMLSchema#string"
             >urn:xacml:2.0:interop:example:resource:hl7:medical-record</AttributeValue>
            <ResourceAttributeDesignator
                AttributeId="urn:xacml:2.0:interop:example:resource:type"
                DataType="http://www.w3.org/2001/XMLSchema#string"/>
          </ResourceMatch>
        </Resource>
      </Resources>
    </Target>
    <Rule
        RuleId="urn:xacml:2.0:interop:example:policy:N:PPS:PRD-004:1:rule:1"
	     Effect="Permit">
      <Condition>

        <!-- Returns true iff the first argument is a subset of the second argument -->
        <!-- i.e. the permissions required by the resource must be a                -->
        <!--      subset of the permissions supplied by the subject                 -->

        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-subset">

          <!-- 1st argument: returns the values of all Attributes with              -->
          <!-- DataType="http://www.w3.org/2001/XMLSchema#string" and               -->
          <!-- AttributeId="urn:xacml:2.0:interop:example:resource:hl7:permission"  -->
          <ResourceAttributeDesignator
              DataType="http://www.w3.org/2001/XMLSchema#string"
              AttributeId="urn:xacml:2.0:interop:example:resource:hl7:permission"/>

          <!-- 2nd argument: returns the values of all Attributes with              -->
          <!-- DataType="http://www.w3.org/2001/XMLSchema#string" and               -->
          <!-- AttributeId="urn:xacml:2.0:interop:example:subject:hl7:permission"   -->
          <SubjectAttributeDesignator 
              DataType="http://www.w3.org/2001/XMLSchema#string"
              AttributeId="urn:xacml:2.0:interop:example:subject:hl7:permission"/>

        </Apply>
      </Condition>
	 </Rule>
  </Policy>
</PolicySet>